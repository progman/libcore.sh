#!/bin/bash
#---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
function deploy()
{
	local STATUS;
	local TARGET_DIR;
	local MSG;


# get args
	TARGET_DIR="${1}";
	MSG="${2}";


	deploy_git.sh "${TARGET_DIR}" "${MSG}";
	STATUS="${?}";
	if [ "${STATUS}" != "0" ];
	then
		return "${STATUS}";
	fi


# set rigth rigths
	chown -R www-data:www-data "${TARGET_DIR}";

# get env
	export PS1="dirty_hack";
	source /root/.bashrc;

	export TELEGRAM_BOT_TOKEN="${XXX_BOT_TOKEN}";
	export TELEGRAM_CHAT_ID="${XXX_CHAT_ID}";


# notify
	telegram_notify.sh "${TELEGRAM_BOT_TOKEN}" "${TELEGRAM_CHAT_ID}" "${MSG}";


	return "${STATUS}";
}
#---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
# general function
function main()
{
	deploy '/mnt/xxx/xxx' 'DEPLOYED PUB of xxx';


	sleep 15;
	return 0;
}
#---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
main "${@}";

exit "${?}";
#---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
