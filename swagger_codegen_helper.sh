#!/bin/bash
#---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
# general function
function main()
{
	mv logger.go  swagger_logger.go  &> /dev/null < /dev/null;
	mv routers.go swagger_routers.go &> /dev/null < /dev/null;


	for FILE in $(ls -1 | grep ^api);
	do
#		echo "${FILE}";
		mv "${FILE}" "swagger_${FILE}";
	done


# create temp dir and files
	local LOCAL_TMPDIR="/tmp";
	if [ "${TMPDIR}" != "" ] && [ -d "${TMPDIR}" ];
	then
		LOCAL_TMPDIR="${TMPDIR}";
	fi


# make tmp file
	local TMP
	TMP="$(mktemp --tmpdir="${REPACK_TMPDIR}" 2> /dev/null)";
	if [ "${?}" != "0" ];
	then
		echo "can't make tmp file";
		return 1;
	fi


	for FILE in $(ls -1 | grep ^swagger);
	do
		echo "${FILE}";


		cat "${FILE}" | sed -e 's/package swagger/package main/g' > "${TMP}";
		mv "${TMP}" "${FILE}";


		cat "${FILE}" | sed -e 's/\tw\./\/\/\tw\./g' > "${TMP}";
		mv "${TMP}" "${FILE}";
	done


# delete tmp file
	rm -rf -- "${TMP}";


	return 0;
}
#---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
main "${@}";

exit "${?}";
#---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
